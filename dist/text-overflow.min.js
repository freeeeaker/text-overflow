!function(e,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define([],n):"object"==typeof exports?exports.textOverflow=n():e.textOverflow=n()}(window,function(){return function(e){var n={};function r(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return e[t].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=n,r.d=function(e,n,t){r.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:t})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(n,"a",n),n},r.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},r.p="",r(r.s=0)}([function(e,n,r){"use strict";function t(e){var n=e.previousElementSibling;if(n)return n;if("x-node"===(n=e.parentNode.previousElementSibling).nodeName.toLowerCase())return n;var r=n.querySelectorAll("x-node");return r.length>0?r[r.length-1]:t(n)}function o(e){var n=document.createDocumentFragment(),r=!0,t=!1,o=void 0;try{for(var i,l=e.nodeValue[Symbol.iterator]();!(r=(i=l.next()).done);r=!0){var d=i.value,a=document.createElement("x-node");a.innerHTML=d,n.appendChild(a)}}catch(e){t=!0,o=e}finally{try{!r&&l.return&&l.return()}finally{if(t)throw o}}e.parentNode.insertBefore(n,e),e.parentNode.removeChild(e)}function i(e){for(var n=e.parentNode;e.childNodes.length>0;)n.insertBefore(e.childNodes[0],e);e.parentNode.removeChild(e)}function l(e){var n=getComputedStyle(e).marginLeft,r=getComputedStyle(e).marginRight;return"auto"===n&&(n=0),"auto"===r&&(r=0),parseFloat(n)+parseFloat(r)}e.exports=function(e,n){var r=n.str,d=n.addedStr,a=n.maxWidth,f=n.maxLine,u=void 0===f?1:f,c=n.emptyLine,p=void 0===c||c;if(e&&1===e.nodeType){e.innerHTML="",r=r.replace(/^(\r?\n)+|(\r?\n)$/g,""),r=p?r.replace(/(\r?\n){2,}/g,"<br><br>").replace(/\r?\n/g,"<br>"):r.replace(/(\r?\n)+/g,"<br>");var s=document.createElement("div");s.innerHTML=r;for(var h=function e(n){for(var r=[],t=0;t<n.childNodes.length;t++){var o=n.childNodes[t];o.childNodes.length>0?r=r.concat(e(o)):r.push(o)}return r}(s),m=0;m<h.length;m++)3===h[m].nodeType&&o(h[m]);for(var v=s.innerHTML,b=[],g=0,x=0,N=!1,y=document.createElement("p"),C=document.createElement("span"),S=null,E=0;v.length>0;){var L=v.indexOf("<br>");if(-1===L){b.push(v);break}if(0!==L?(r=v.substring(0,L),b.push(r)):b.push("<br>"),"<br>"===v.slice(L)){b.push("<br>");break}v=v.slice(L+4)}for(C.innerHTML=d,y.appendChild(C),e.appendChild(y),g=C.offsetWidth+l(C),e.removeChild(y),m=0;m<b.length;m++){var M=b[m];if("<br>"===M)x++,e.appendChild(document.createElement("br"));else{(_=document.createElement("p")).innerHTML=M,e.appendChild(_),_.childNodes;var T=0,w=document.createElement("p");e.appendChild(w),x++;var H=F(_);if(e.removeChild(_),H)break;if(x===u){if(b[m+1]){N=!0;break}}else if(x===u-1&&"<br>"===b[m+1]&&b[m+2]){N=!0;break}}}if(N){if(E>=a)for(;S;)if("x-node"===S.nodeName.toLowerCase()){if(E-=S.offsetWidth,!(S=t(S)))break;if(S.nextElementSibling?S.parentNode.removeChild(S.nextElementSibling):S.parentNode.nextElementSibling&&S.parentNode.parentNode.removeChild(S.parentNode.nextElementSibling),E<a)break}else{for(var k=[].slice.call(S.querySelectorAll("x-node")),O=k.length;O;){var j=k[O-1];if(E-=j.offsetWidth,j.parentNode.removeChild(j),O--,E<a)break}S=S.previousElementSibling,0===O&&S.parentNode.removeChild(S.nextElementSibling)}var W=(_=e.querySelectorAll("p"))[_.length-1];W.innerHTML=W.innerHTML+d}var q=e.querySelectorAll("x-node"),A=e.querySelectorAll("p");for(m=0;m<A.length;m++){var _=A[m],B=document.createElement("br");_.nextElementSibling&&_.parentNode.insertBefore(B,_.nextElementSibling),i(_)}for(m=0;m<q.length;m++)i(q[m]);e.normalize()}function F(e,n){for(var r=e.childNodes,t=0;t<r.length;t++){var o=r[t];if("x-node"===o.nodeName.toLowerCase()||0===o.childNodes.length){if(S=o.cloneNode(!0),n?n.appendChild(S):w.appendChild(S),T+=o.offsetWidth+l(o),E=T+g,T>=a&&(x++,T=o.offsetWidth,x>u))return N=!0,!0}else if(T+=l(o),(S=o.cloneNode(!0)).innerHTML="",w.appendChild(S),F(o,S))return!0}return!1}}}])});