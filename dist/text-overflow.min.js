!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.textOverflow=r():e.textOverflow=r()}(window,function(){return function(e){var r={};function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}return t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p="",t(t.s=0)}([function(e,r,t){"use strict";function n(e){var r=e.previousElementSibling;return r?r.childNodes.length>0?function e(r){return r.childNodes.length>0&&e(r.childNodes[r.childNodes.length-1]),3===r.nodeType?r.parentNode:r}(r.childNodes[r.childNodes.length-1]):r:e.parentNode}function o(e){var r=document.createDocumentFragment(),t=!0,n=!1,o=void 0;try{for(var i,d=e.nodeValue[Symbol.iterator]();!(t=(i=d.next()).done);t=!0){var l=i.value,a=document.createElement("x-node");a.innerHTML=l,r.appendChild(a)}}catch(e){n=!0,o=e}finally{try{!t&&d.return&&d.return()}finally{if(n)throw o}}e.parentNode.insertBefore(r,e),e.parentNode.removeChild(e)}function i(e){for(var r=e.parentNode;e.childNodes.length>0;)r.insertBefore(e.childNodes[0],e);e.parentNode.removeChild(e)}function d(e){var r=getComputedStyle(e).marginLeft,t=getComputedStyle(e).marginRight;return"auto"===r&&(r=0),"auto"===t&&(t=0),parseFloat(r)+parseFloat(t)}e.exports=function(e,r){var t=r.str,l=r.addedStr,a=r.maxWidth,c=r.maxLine,u=void 0===c?1:c,f=r.emptyLine,p=void 0===f||f;if(e&&1===e.nodeType){e.innerHTML="",t=t.replace(/^(\r?\n)+|(\r?\n)$/g,""),t=p?t.replace(/(\r?\n){2,}/g,"<br><br>").replace(/\r?\n/g,"<br>"):t.replace(/(\r?\n)+/g,"<br>");var s=document.createElement("div");s.innerHTML=t;for(var h=function e(r){for(var t=[],n=0;n<r.childNodes.length;n++){var o=r.childNodes[n];o.childNodes.length>0?t=t.concat(e(o)):t.push(o)}return t}(s),m=0;m<h.length;m++)3===h[m].nodeType&&o(h[m]);for(var v=s.innerHTML,b=[],g=0,N=0,y=!1,x=document.createElement("p"),C=document.createElement("span"),L=null,T=0;v.length>0;){var E=v.indexOf("<br>");if(-1===E){b.push(v);break}if(0!==E?(t=v.substring(0,E),b.push(t)):b.push("<br>"),"<br>"===v.slice(E)){b.push("<br>");break}v=v.slice(E+4)}for(C.innerHTML=l,x.appendChild(C),e.appendChild(x),g=C.offsetWidth+d(C),e.removeChild(x),m=0;m<b.length;m++){var M=b[m];if("<br>"===M)N++,e.appendChild(document.createElement("br"));else{(A=document.createElement("p")).innerHTML=M,e.appendChild(A),A.childNodes;var S=0,H=document.createElement("p");e.appendChild(H),N++;var k=F(A);if(e.removeChild(A),k)break;if(N===u){if(b[m+1]){y=!0;break}}else if(N===u-1&&"<br>"===b[m+1]&&b[m+2]){y=!0;break}}}if(y){if(T>=a)for(;L;){T-=L.offsetWidth+parseFloat(L.getAttribute("data-margin")),console.log(T);var w=n(L);if(!w)break;if(L.parentNode===w?w.removeChild(L):L.parentNode.removeChild(L),L=w,T<a)break}var O=(A=e.querySelectorAll("p"))[A.length-1];O.innerHTML=O.innerHTML+l}e.querySelectorAll("x-node");var j=e.querySelectorAll("p");for(m=0;m<j.length;m++){var A=j[m],W=document.createElement("br");A.nextElementSibling&&A.parentNode.insertBefore(W,A.nextElementSibling),i(A)}e.normalize()}function F(e,r){for(var t=e.childNodes,n=0;n<t.length;n++){var o=t[n],i=o.nodeName.toLowerCase(),l=d(o);if("x-node"===i||0===o.childNodes.length){if((L=o.cloneNode(!0)).setAttribute("data-margin",l),r?r.appendChild(L):H.appendChild(L),S+=o.offsetWidth+l,T=S+g,S>=a&&(N++,S=o.offsetWidth,N>u))return y=!0,!0}else if(S+=l,(L=o.cloneNode(!0)).setAttribute("data-margin",l),L.innerHTML="",H.appendChild(L),F(o,L))return!0}return!1}}}])});