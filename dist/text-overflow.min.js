!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.textOverflow=t():e.textOverflow=t()}(window,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t,r){"use strict";function n(e){var t=e.previousElementSibling;return t?t.childNodes.length>0?function e(t){return t.childNodes.length>0&&e(t.childNodes[t.childNodes.length-1]),3===t.nodeType?t.parentNode:t}(t.childNodes[t.childNodes.length-1]):t:e.parentNode}function o(e){var t=document.createDocumentFragment(),r=!0,n=!1,o=void 0;try{for(var i,d=e.nodeValue[Symbol.iterator]();!(r=(i=d.next()).done);r=!0){var l=i.value,a=document.createElement("x-node");a.innerHTML=l,t.appendChild(a)}}catch(e){n=!0,o=e}finally{try{!r&&d.return&&d.return()}finally{if(n)throw o}}e.parentNode.insertBefore(t,e),e.parentNode.removeChild(e)}function i(e){for(var t=e.parentNode;e.childNodes.length>0;)t.insertBefore(e.childNodes[0],e);e.parentNode.removeChild(e)}function d(e){var t=getComputedStyle(e).marginLeft,r=getComputedStyle(e).marginRight;return"auto"===t&&(t=0),"auto"===r&&(r=0),parseFloat(t)+parseFloat(r)}e.exports=function(e,t){var r=t.str,l=t.addedStr,a=t.maxWidth,c=t.maxLine,u=void 0===c?1:c,f=t.emptyLine,p=void 0===f||f;if(e&&1===e.nodeType){e.innerHTML="",r=r.replace(/^(\r?\n)+|(\r?\n)$/g,""),r=p?r.replace(/(\r?\n){2,}/g,"<br><br>").replace(/\r?\n/g,"<br>"):r.replace(/(\r?\n)+/g,"<br>");var s=document.createElement("div");s.innerHTML=r;for(var h=function e(t){for(var r=[],n=0;n<t.childNodes.length;n++){var o=t.childNodes[n];o.childNodes.length>0?r=r.concat(e(o)):r.push(o)}return r}(s),m=0;m<h.length;m++)3===h[m].nodeType&&o(h[m]);for(var v=s.innerHTML,b=[],g=0,N=0,y=!1,x=document.createElement("p"),C=document.createElement("span"),L=null,T=0;v.length>0;){var E=v.indexOf("<br>");if(-1===E){b.push(v);break}if(0!==E?(r=v.substring(0,E),b.push(r)):b.push("<br>"),"<br>"===v.slice(E)){b.push("<br>");break}v=v.slice(E+4)}for(C.innerHTML=l,x.appendChild(C),e.appendChild(x),g=C.offsetWidth+d(C),e.removeChild(x),m=0;m<b.length;m++){var M=b[m];if("<br>"===M)N++,e.appendChild(document.createElement("br"));else{(j=document.createElement("p")).innerHTML=M,e.appendChild(j),j.childNodes;var S=0,H=document.createElement("p");e.appendChild(H),N++;var w=F(j);if(e.removeChild(j),w)break;if(N===u){if(b[m+1]){y=!0;break}}else if(N===u-1&&"<br>"===b[m+1]&&b[m+2]){y=!0;break}}}if(y){if(T>=a)for(;L;){T-=L.offsetWidth+parseFloat(L.getAttribute("data-margin")),console.log(T);var k=n(L);if(!k)break;if(L.parentNode===k?k.removeChild(L):L.parentNode.removeChild(L),L=k,T<a)break}var A=(j=e.querySelectorAll("p"))[j.length-1];A.innerHTML=A.innerHTML+l}e.querySelectorAll("x-node");var O=e.querySelectorAll("p");for(m=0;m<O.length;m++){var j=O[m],W=document.createElement("br");j.nextElementSibling&&j.parentNode.insertBefore(W,j.nextElementSibling),i(j)}e.normalize()}function F(e,t){for(var r=e.childNodes,n=0;n<r.length;n++){var o=r[n],i=o.nodeName.toLowerCase(),l=d(o);if("x-node"===i||0===o.childNodes.length){if((L=o.cloneNode(!0)).setAttribute("data-margin",l),t?t.appendChild(L):H.appendChild(L),S+=o.offsetWidth+l,T=S+g,S>=a&&(N++,S=o.offsetWidth,N>u))return y=!0,!0;L.setAttribute("data-offset-width",S)}else if(S+=l,(L=o.cloneNode(!0)).setAttribute("data-margin",l),L.innerHTML="",H.appendChild(L),F(o,L))return!0}return!1}}}])});